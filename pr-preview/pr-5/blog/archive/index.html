<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>House of Stake</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #000000;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #000000;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #ffffff;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">House of Stake</p>
                        <p>This content is protected. Please enter the password to continue.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Enter password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember for this session
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="Access Site" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Incorrect password. Please try again.",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"641f941e61143315885750f8f75a879eb6c5ad89f548ce5fcdd3420e703e0990ba8cea3e40eb314a171aec1c8f5e9b99c56775aabfcd60ae61e30d02f897a2bf0f771ab40bfed22e4774cfacf19f8cc589961c2f185246d7d1fe035397bc172fc0ee30c5376ae5e2d69ad6149bc503494f69e913bb04624ba25d18711a805d2459ca829d6747bbff443b8356aaa60b084fb80638c4aa2d517db2aa051bef4df41332891fa613994a79fdba9930c6624b3ee80cb119b69a5a601020a56b0bce28845879853ab5742784e8b3aab88eabd474d4cc96a59653d50bf794894033fda3ca26040e6b389dd77a15bb677b11857e90b512cd158d7c33843ed7e8d8a08fc0f9b1600f9b073174274b3ae52e7fdff299116b1b6b9c65f79df9ef31335e317ff702d0dae8a87d5fbade08af5bbe3f13c9b82417b75aa90a4221a3ae2f73d46bdaf821c1618778401fddb46294202c7c49b5ec86c4a830b0af640ec6862127ac8ad987ac8dfdf88b4043fb08bd293616cf95fd5a084716c8ad83c55ce757ffc8daafe49b53843f3ad67e24d6cf7b71b8a9b8bfd1750b082bdcd9d34ffb0b1af2f5d14fcc6c566bfcbd42592cfe5bccd4d35d9282f2cb0335e975f7d998ddff5cc0def5ba458313cc30bbe585c78ff07a6acbf1d093fe20c4fd3e97742eb6201561a67a1a0b05257ede74f15fc2a7154d90e73961d167d226ba30e0cefae70041a1fd319a726edc0e2a51e73823d6548a1144951857ba158e15d3392582d61d926738a415dec3c24aebda5d8f94b5952ec8984b3061b832abe245b91dbb71d6a0bca23f8fb6c28c4dfe33c1c22605d6d26fa3cdb69c930ee5645876eb8df94db173de0db93025fb805144933049ae8954d9b90d79e4871241c4a047f8a381b14a46af1a29bd10a9eddba73197deabf885babf3c860b2d68e3fd4909988b723fc91ebab03d8cc22d30fede1db50c1772987d6fd7f8a49f00a660a2e728c11623bde574425eaaca4c0138329ad85d1a0024e0278c2f4483d682441eb513d215f1796e0b1a1f25e482d0bc5b2b8e8bfbdb9099b365cc93b002b3b4d190181cab2c354885848adf14d2fa711a5702ca6939c9f949d3191eca9460e845a2883a0fff039ca4b9d5b4820940b9a0a5b513e27107485b8ff45760f3b8712652e635a59f1e151c6ec7ddf9f0e30013da496d879aceefb62ccfae8b1cf31b8baceb7731c829989398d4b054a917927501f32c9d5dc7916aa310aafb32bb0f50cd541901891ed56b73d42fa4a2310f4ea75b384403565f4ae05814ae133b53a5556687ef4bb2e2722342b9ac82f068513ea1a7ae6052ee8092e21a0b896b4be094aeb928b7360b877a26d6f2c7f3e1fa0451dd2761cb1730ef52258972a7af0e1acab9b72e56887c19fed94bde418bb4f7df0f9ada3b94f558db8d9687a0bb956d0402352dde7bc6312f79088a420d7fc7124dfd11060ece219a2acee7144e5439264f9ed733c641777ed5b67108f493b13c2aaa4e4df0c49e142483f0b4a4b73caae53eea2664dd7d070a8cc607f7e14922524bd0ce1c3a53d37ad5b0d5cde9d71e25e0965871cccb72ffa42c6702c35fd959a50d1179ccc485c5ea70a6386a229906dc2f09431be168a866aca87ca620330c1503c5c0f88d6184cc8cde9dc5c2b5ef2fed5a6d26db51c568833b27830269010107645b77c44b5541ba3bb337aff203825b0dc9b8bb5900a5b16ee4bb4c4412f233ca70c047a0408b1fb7c4060b9c87fb80ffa73e206cc3ee54a15a96391516cc9f4e19619110bb6c5b6599cd7a70790d63505748cfb5fa97fc2fc3b8db1339e9443560bb80a9f6eebb2e7e3d6393c46baa7d5fb01539c5a2497204b877a3b1c9178b914a6c340009c944a2f2cc1ce10efd5c215100d06b3c6a1aa6ec1cca417bfbb88a5c7a48144e46f0413edc403b4587f6223857c015a72f415579f390966452d2dfc4e660d7123a5c5880222d5174f67d3ce94cce77848e29784d091b3fa7eac2e07cb11961eb78efa2c1362116757c1f5a057a936210a7cdf1422b0e30c2dd62a09287d65cb4c9c744beaf5699de5a1380908980deb75ddaddaf3ef55da2ae95a85c73fbe7f0f1c1219b57511787a9383a631b5e2e34911f5af8e9aeeac1b88939dc5dd12d0476ff3210762276ff7ff03d91398ba311a3446f7762fd83731692d7bfffbaa01fb4713a3ce0982d97191e94ccbef837be6baf8b96c34cc362f5668f1094fbd07879280a6955224228ff270c7c21fbe634c5d028f0a6fcdf6494edda7f7a5301f6b2b7cd3d3423afb02132728b19c67833efe50a84d21275b8ed3ed948564dff76a7c3a44bcf5e2fd23d7b32419993ee7f3ebd89abf5e924cfff52cf702d6385ac4b67b5a11cc2ef77bdbeb2b7db11215c032644eaa2dc010f54879fd6dfc1bdcc0dcec5de59740e5589ae4caa97fb29aa6b0fe6f050b38e2cdba0010596beb6dea1f5526cdc73ce6c6dcf67675c9867277fdc7d9d2fbbc4d6a2e5cc5f85ec1ed870b558b3473b451575583ffa98d14b48ec95957f2f64e5ef99a780b6703b92d9e46744775c0bea6a026cc5e8ccfea0af04abce7f857e873959009dfc6bdd5c64e3642ab8e8f8cc8349b79a9b84a8c22cd8c7861a48a384a10ce8e9126de89c5d0dc2bce759a72fa65bcfd2347efa51bc1bacb27851fb5b05e7ed14f15f4399b1efd45c055ac7dce46b1c84f6c695e79f7b74fc1c2134285b3aec78fd7cc82999af79bb813495959af5b12885febb623aabead7921c9a9d1e90e0241ac4922f7df2904667ac4dc1a53c9376dd2bb83c05951c9aa86efefb8b23cfbe820cfe49857fb922b3a367132747d3894634c0aeb39874698058b2d78b73fd1c665b011c8c82a433b2a271de50a8e9ea0199409f1a304530c328bbfdb1b70423ecac8df05b835b82c93e9825cbf7585c9e97bb80dc1501614c7de819e9a428a82414576a3b7b096b2802ecfc15dc614b44298d666acbe1aea07d5bc011416c6252ede5b6d1c2251448f6748cb6f1fdab6b2829d709270aa93c2ac469641e5622f0eee20ee40a88214ffa4ddbc9dd5ad0af323c94d80cc84e2cd4d97a61f8a0ec5d74d4584db238b7cfe92deaeee55907d85506cda4138a3e23ab3dedd56b77cee2bfe6baa6d092be99b1653779bb64ae264f02fde1e42a4c8b78d6afe9d4945d7f8901817445e0e0b8faaa76c14a9ce555605c082296c07b74ca6546f149eec157c0f436cb73aa9a8c22bdd3cf3b3fec97bc3d29c860fee0ccf78567605254d38d334aab729b3802391a2525dc763a9e7ee14bd6167c0775e59133e686171911be2f392648eb8792c63c92ef150d6f281988b4a25e44fe252850f4b831e975f4530eed7c47867d6938e9c03fef9469dde208104013a9330bc3ede055437c3bf1b7a5c8466b7daf1728765cc4416f71bd8afdce14fcf2ce97c73aef5ce00105a2badc9c9fecee315c8afc42801d50de905fb19c549779bd7672c8d86243ea7e51add8c0cdbe1d3ad34e065d4203722bd918e266b1f034a6e694129b4ccc422eebaacc34f3270541b0ee1603fa9dff0a5c1a784cd0650e0d3efd1f10f630de9b89a9dd589aca4140b565e749e821722712a02dcad603860dfab9b2cd9fa3dea2d98131580072771c1751d137cdc69e3cbe03efa3fe9fa9b05d547e28be5dc2b6e33ae21bbe96c696d7d69c059d7a2cc51b5928551046fec8ada55595d68fc94459fb25b2e3c1eb6c676df2d944e3a93ad0cb0dc8b7c4bf95a836841e0a054ebb115dab0e2dbab0b91d91f61e91c9dc27744e23549cea61be8dd149a39acff3716a1c94d405c718de02fc5ed2f3e4cf5974b44d3b7a031a28413bcb6c6cbd99910014b3265b094d4f2f494be4fe2fac67cc857be0b0d9e17bdddb2868006087b0d545b934872cde717134f6e9a9ad094748763f7a340ef0aae1150fd08c48e3b8c38d4e638640924517adddf91b7aaad628f4ca87a455c34621342e17bd8ef39502c1ff9d0d7bac7ac63ec05375883c91fe31314a77518782d5b6d70f988e847693f89fe1db5d687827a1ff6397aeb7833a61bd591f9f9b688e24536d8801762596a22b6fb1b7e6218b6cb6fcf8511ca66cd5c004b579f43aca7900ed1614677de36f29fea1a6d3583ea6216c68881b50306676d70495dae24b5d328dae054774280bc55b87d9591a12edc673856ae38d43a506f4ae2cf3801393fbfdd0ea9668cb606a73047c1d823f18153e5186ff9b6aa46f6ebaacf02605cb1c12e4d2f49be9e5802ec8101c39840244e6cadca2f4ec5cea5ba4c3f1540f3a6ecc2251f0df3f262bf50bf748413d5c3af68bd08f42640dce0ddb38ad91ac7b8ce7371b71e580dd8321a31da19cdd597c0e7d9968c1f97e0d2e54dac1f122076e250525b15f42d8dd205ce1cd959bcfd3c31eeebb3a35fb73c5880f25da405ebfbfeb2ae33a92467bde27b0ac4d4767049b6e6468d1722ae3e225656fceb0278a6ac17874d093791e931e884441cc2dd7a20543891c6fa312ebcebda69577818ce83f56533896d69eafccc60f9d526f825b6d0e247f85c4e57a8c546b702f6fea01e1c79bbde11038830df019fd3f42cfb721badcef41cf59e306c57c2be928b8472d48dab66097c22fd9020c6274b836c1a39651992d3d1df0de09400dec146cbc4b3302c4c92af87e314515c3f33918e3b9415619ff154922054594e8bafe2cc52894c4cd19fb90cfda4927b44f4e82303832fc453b9d2b1adc5cb10a0107e970aa073b0b39febb5cf1f0b4dcefca57f4f93d4467252ffa357f7ed70e3d2b2860af3a245f4be8c1fe53387b33f42724d7376396ad922728258a474ea166d97470b22dc32369782d8030ede3beaaf02a17d04617db87973df42da8f4fdbc3b4c40136036aa9dfd58e0f82e43fdcb255f4516fb6f09fc20fbfb0dcf85a2b5e5f602ab2afd64b7449f6f89e2b32d8796f949c0299ec23637ceb8de8ee7cb0b0f22b8ad4c5365e73196be5e5149bca817ebfcbfb18a8068a25340dc3a6ec53d33364c7e6852aaba30d2a890860bcd9ee3f4095d226a93d6d0c8c8a115d715f728f80dd41f392a0bc9f75cfa12683b45b175e59c893cb8fc57acc7a32c826e24ac141dc7b0967a9e317291cbd8c18f467ba51836950fa3c91087a8cb2ac3ef52fb4586c01d1b46b9d2b39d1277fb5e170f311aea35fcc468afb72d1dd30c2a31d6643dfd6f65736b7c90adadef87e74ac492480def8fe04718e14b3dbea23a712f12f856a3d51ffe5622fe577bff6dee0a647e3e9cf40edf95e30550ecc70ee229ddc0b8a09907016411a69ba0276acf945707642e5bef0cb36ce036ba0777d9d44e7a7b7be274089a424e0b991cd096945aeaf7a7a6fb72b06992847af2b3ab1a18157d83d600380e0a5760550cc417d4ae1f250de575d3dea5de2fd25e4c08553d558f64c8adde5c70c09e037f3ce5dc549f84d82000957a0002d5c112c7254656f2d8828f37537042a09d16962e1b6a1536f2b3d677500b5bb20114ef207b538bbd7608febac9f9beb7f305c9a52fc7329776bb0124561b5c925aa44a76b41dab0bc030fa6c76b0eb306ccb3229249674289bb1937beb9b9147f227240930d2cdf54e2425256e92cd6c571843315af11cd37a416ec87cee1ef4496ab3e033643593473005eb9e6eb6ec0d41aa9bd6cd82153b3fa739911f41115f531bdcf590d913383adff774d0f4036b84d2670576a6e971e81962d1a78e3fd972ed2002b4e1a475dc6f4734d12bd256c3243b659eeccb26c21b0b891b1aaf59ee513496f4ddece33617061a1e7d7c24e46e34dae09a381a445149a61cd1d34c35ccbdb3835db08be0d1badeca21605bbebac034e9cd6eb4fb2efe4ca63adabdcb0deb2f2d0d2a4cf31fcb3acfdd9670878270a7ac5c648eb4987149cc007c3631113ab48e7249a6b38fe8f53e8bf7d0b7933e724edc2d6c1ae4213bf795bed80a52b63f8d052cf4946acc415679365a95c0948b3f17907aada3e534b8035f26f83f167835ec34b49261319b62f63869d17c4fe1508785df361a790a86b7070b464c9ac245645abf7754d4ce5993e3190644b95877c1ad6a06081c28f86701a89cf07fc23f62090d57440da63b919062c549bb145cf845c7eb8937e2e232737af65ab873c275a59c21b629715b2237ccfa563801132a98fa46f9e62194dfa69e68fbf8771a037a0122563d97ce7a37583d21fcd3e22527dc84b42435f19cb9b630496b438b1a4c46d65564d029413d563ef24ce9b8fc680aedc77ec19aa4c84c3f31c99abb271f5067f43655a0d770489fc8248e58e247462ac587217b516f6db4a624b107456408d2d0e96aec1ab0f706b271569998abc870343e6b82ab760922b66e03216e32d0c1623b6086e283a1bacc836a41b53d616c97eb78a2af2860b4d6bac6b7947f64458342260811f89c2b2be2fab0396df47ff350a03476d28b367e077f4a43f1153ac37e752262836ce1c92b5764baa6b5c492450ad5e06f41673148b5fe6d99129e9c609f481dd8488ad8698ab20d7b07dcb9e2447b373ccf3d60ffcb295bd30d3ce5355eca4906b2949763c2dd739a36c1071a24954a1505937fb1b1c2c12c90f0c8232c1720f3ceba5a2c5b89f2b6d46870f52de4017c1d6499903637a1f89af63655cc5c110a028cb215e4ee71d5d1ed77c934fbf9204e80336fed8ea5dd23c70b88a79ba27cd565f2e3aa992cfa6e828275db11db66fa8e56c840f7fb5f76e60fc58faf35a7df836b9135a5bd91cf275d5d658ed581b70f46348c3bcc8c4ed0761e34ea54a80047458759abb0a1c3256e9c4fdad13c1f9f733ff9466459dac8ef561cee7e0e8703970692c4db48d497addccd416d7ba1273b2c80917507716b4e290260b1001b096b68164e79936441fbf36de2308fe17a2d0d2e56317faca7a1a6e1fc6df9e88130419b212ea31257391d46c38cc2836ea78142dc8138ecde80b3ca064f83d7cc96af41bc89306c6c99aa1e2d18ca408d0746212882b4a8b7b2eabd6e05edf4b88547970722d91dbc36bf7fbf15e9b3bb7a021c9446bc00181ca01a96dead44544db41b25b9acdcccd6f4db5a657bc3d313c0dd3d628b3540e91b54bca6648db117d6bf3b81ae5e5ab85b1a0ca9c1fc182affce4c392e8abd53ae25a36b408e8a06ccc64884043b3ae4b58a21a8fb4a829bdfab479e3a0baa4b2fd855a4669bf3a134b71d78afdc8c927b42f8e075135b90910fc6e64a40cb282476b148c0b9810fe25ab660e47b0caf6782d870c6e5643f147fbf220e291b9ec25b12a4a41ad284acd36b35cd4bc9b29652563ace3c0ce9008ef36c1486494d0141445683bb096a37d479c3965a6f8bf14ece855e5699cfca92e12153f64c1bb005341193d35c363a7851d7aafcc7621a05079ebeb53ca421dd3898cdcc434f3a015d3b4cccd3066387e1311cccb97b6ea6988060c465a240bbee413bcc9e9f0dd3197ae33f81128d9aec5b40dee4df75bc3f985665e29ec6930d5e90f3c9a84206dcb50d3cf015a480c82421b0aa82b980ac0d308584ad8df93f36db09dfff476efb4d975ae411a0100fc308cf7f2ba30cfda48c714451c2a0bfacbf55c926fa3b40ff7a8b3411dda3f2d6349d192cbc6de2ba3cb8073b336a93e0a5387a54a888ea89362ef116bc71485adce376f3cfcf0eaff4c84f9668c10b0749f9c47ed709146ab8eb56b152d2af598f88c4bb75d60d7c6bc01730e2a90b88f461ca68ad52224b5d1ffff6c334a7a414799bcbf9c256bccdd954f97adf6688a842a9a8e9a53a329981dbd52aa1677ca7727a238227ac55c62142f94ae6308f8d2ba6195fbc6af1e7f058fa75763463a507951c4b6c13ca7d8b53e5a73140ce23cefd8ca09097685f484ba68d06c85000ec574f297bcdb42049a7a61bcaa7a57ab42c3cb162de7395ada09d9265ae01a79139b661368826e1258a32ff2c4f3c6b42e3d2a1519e20d0e116d10bfa8869e0c5f3a93072a556313cfddb9f7f31224b08bd974ffbff7c056131113f68cf9f47d121047829ba68f04166e76bed75bdb0c6cf410099f629cac5fd15e5224ca4196180e19e53e192b9aad67dad43e4873437519fe12da5cb85da56e5dcbfffa7ef493c206b51f09707195aaa352ce7b965471c56a257091a662d9e68b30d197b7a015b9cc05a0d9760047b1de8bc51ff87f0da009b64ade6de852cf00181f345b07ce23836c794601070a29ac5c69ef2f1ebc78aa79731165b330457346d212e57068f408259a71b9cb89e968bdf5cbc7f2b2c1f4fcd12285910d52ad6bc0023b5e81cd92d618bcc9809f4736b6d0f62b8fc6a08fd96406a53661c6bb69de69436a06994adfdcece01575e08b036fbab817b24455735bd628a8e261fd6be107cd8367fa3cc7e616323d2596802a7ab7f6fcadafcd2b4dda0a5738b2e53800ddfbc28d2fd6e47aa39d2e4f5845e876bb9616d3bcc6253afbfac9ba6c820da725d2eddecc73b9e49a91667fde40d5e7aeb2ed05a9a0c8872d7425fdde566944f611a01ff1e887bf5449823e46e6fa3ce881dff76029ad9686650aff1836039214e10fd18663705eba12baacc08fa7ba3d9265d5a52f18a252bef3be97bab4bb4ce4ebdef1469b321da438960c6e3bc4f7f08c97c60b41d47bac3cf2a6e0f33981c1c0a0c571b5a942c3e7f138460168a72fd23fa9dd0f68a372dc61dbb0157b62bd952632011194744825ad9838452a6c1761c454a83467799c5522cbc99945b0fb43929ae30f75c3259eefa58469f9872191a0280a49656b9ab9e90bd3b720ce5bce57301d9893b421adca7751a7f429726f2be55650ac01c442c2248b7ac793829492e31e8d412109c54091d581f12330a94a19e27a328d92cf3aa1f4cee0809d14a6cad680497b49c349cb390f5eeb6f338a6fe623591fc269c01238a29b7355efd7612b0cb0683230cddbe70acf7ceebe72e66f61463cef5000a61bbcac4d7796d56150db7db4665f6c328deeb413bc449a50342c256f46ad81eef2c43b3f84ca60ce10e95eb0023d43d5ac6538787fb7ceb9640ad2fa362e51f7c3954274c0a80fb76af3a697b63510b344f4539bf5c33fb06bc8e01ce77c3431de6deedaffb5b03c23dea658f8a6f4827cbf30bb0abfc723b4112743475636c2f7be3b08691108c03cbad589ed26376d159a2d998e70c49a8864dc5219c95f46c640c3c3fdbf127bb53631c497e3fbaadb812180d70098e1535b3e30752e03b570febbff2893cef98714ba5b1cae1b819a3232d7491a4ddfbe75f175f482379fe53f25342ae61a4ad8b17be113e80af10bad876fd638f42a2edf03f1ce8115bf1484645dda48d368abf6325f79264945adad5ede4df5900ea07fae913df407e9d9fcb83b5294a6b9f227291aaad18d0e4eab6a50e1ab2a501867428a9c4ff40b163667c48951b348ac81cfd863e44896806ba9d5ce2a3d5337cc5425bbf134e5f271edd5e4b9778f3c0e11228d3e2f9f56dd013f1e1d49b6abcda048e10f81c4d3a7c73cfeac9c0da8da2e355138e652cee79f41fcb5b41126c791118cb74f631dbd04c07acd2236125c1620f7ee10eb7701552d0657aa71046b0bb054d5cfedc60fbffbcb1ad803277a0302ac4ed87c8d4cd6045f08b21e9bca1b58d0c1aeb12d5cccaf31d98a85a14e795014e7d3e24049ff4f2c5aa6a9e4217214845dbf23a5e7d604c0e5c6c1265df7a5cb22025722f5bdf0351c4ab4c9dc72ff3f727b7d4ee7558998f808b93a1ffdf36e6c0ad927b5036c5dd4e2f60d781e6ddb4ada4b1ab98b541d83b57d1bc69e55a2e130364fe0e980363114e5b6cb5649d09cf0c85d60b4e97818c179135a6f413a99e996d0e2c0a90124e62404e44e8bc67adacb7bd92bbecda009ac5ccd5a9e2196e3b15b2433e17d67e80b6407f9b3cf5c5c40404ae2c9ff342ee7ed8b56dd80da1379f19069dc3244dca936e93a5d6cccf758cfb5f551a178c9de2904704dbef7798a1c0c4404f49b6347dc9488d6c28d2a04e98fddd1e46f038867f4679b12deb8df202876cd18d79f70ddd6cab7c6b0cf7c2e386534482c3152640b500347dc0368c7dbde0a2d7f7d87128dcb98c17ef46ce1193338dae41fd07ad6c2a1e80a98f0ce094737a9aa7f91911cf980f978b95e414985cec9ea788f929d28965186f4a9f8c7ae05eac589fd7a6ffff1fd6b7022cba4e6602fbedead6c0637c0543239f185e9a9d51b0b9fedbcec257c9f8bbd344835acd9b9c54d6b881d757a0e29c2b88264fa5ca652358722589e2d43fa4260b3bc8b64775eecfe34ba023f748be417280c0dd184ece976fc0aa957cbe43768e090eef29a1118c9cb9fe8b6ecf77410fd6d7c67f7ebdcf41d99bf227b96cd0e14b1fe796660bbf0c5cb3a9209b909c6996f22f3f3d961604cace28ad22882bda039f61fc501106cff1cacee00658ba3f7001fb82294b97e6ae1763a5e3611e4029accc394f39bbac851f054064380632295c02c4655409fc220f0036f5e0be8f1cc893c32e0b6bd66165bd85959a512b68e3b2b11c3d960ffb587c9ecac8689f3f75321ba194667c201d0721c82fcaddbea40db0c15df2206f55dd1da852eef6dcb782851e9d591edfa4a46bb83852dfd5b79901d841f6adf48fb52c70445aa7640687d844d9dc599f5214f6aef662151ea265ee440663eec96f22da9de50cf174a0a39e214179d202d68d4e29da9d755faff754e45cd740edc7141e88d2c7ab99d75b752f268042a622c9a27eba147757bbf515da30213d67f7c3479cbade87c83b7c8015bb05627348a47690016c3850231218b9599559d37af1bb056e31eddf3504cb8001b3b7fc5c0cc4c3ed1767ca366d0754f5bbfe56b0a4d279b0ca77c6373e3827f10d37f779f0e7e83eae2a4f37892d2d0a18c88da5d2dd55b5b3d87c44f5152520f061f64a8470ef1b23649d54078579997fcde97e258d3fb50c0d01456573dc4bad8bcb7c0d3a1fa1d0fd5e332789a4f127402edbe9b2e22879c6f44f916960d40063d1cad673865f28e29a83db0ffefeb2d64d720f6164a48ba72792aac572ad2a671e51be34d22179278d8b7a5957fb47cd505b378d6c6454a256b12859138569f327892985c9ce1d9720f52a423f8502824c9515a82ea45a2d97935bb9fc114023336c11ad30b8a6f0e047289dcde5beb7fcacb957d384c5dc7cc0f976aee53fbd057120d035943afa4db25fb57014bac5ce6bf69d0f5b2b1a2fe46d2c008a2e64f0a9bc6ca9ea8bc27426e55bbdf32a7d4de2c974222db71463ae87a8a3f7e0bc2ee3ce22272e3a8e7abf5db01b869665d5aa199d48cf33ce6b8749a3982a1cceb27c1fa80d24896be9f056deb61665f9225aacaacb45774a53aec1e0aeab5d5ba442a986630a1c464099218782430d1040d2ce8772c6227fb94a9a16e3c50f288c44c86703ba584092d48adad14f74a68fc441683fcb28def86bf42f9de82768d0d73ca586c038b87b0f696b8f6b170d7fdb68250f2b09c99a7aa8425905dd117c829b8d8fcff28bfca37fa7752b935333c6910eafa8abe167d82fe39650301250f966873a4d73dff7274f79b02cf3fe9ffed1503ac71994ab45908a0cc51c33f3b8e6860665275817aaf2aa0a85a9e755bfc7a493ba898f49a6c3cd7644618a8c60a42e539a26a32887b719b7a7baf797e4c11be36f2c750018aadf739efd092d1950c04f154d895a8c050388ffb3aa38717eca0f53aebf8bba88a5faa397722e619843e05398959f0b4996a22724279036d4aedbe6d3417c5a0b2a9391d63243f985c83afba960eb70401d325ba1fd52ceade670df9e9c0713e97f15fef323977e52d09ab75a4c94c66b68a9ba5efa3cac70892c4f5c7f41c7ceda1ebe9a25cb489e1e40679d8f4686f53af7f17656d0815756e43de3e496a44929634e9fdc1513419bfb3bf17ff06bed21ec21cb9493543b61b4ea1e28dee3556ea4e7b20c29c83b3aaf7d2ec46913e1478a9a622fb56ca8276c93bb747e8e2f02ccbb4155f1ccb0a9a056763fe83c8c7c780f5336d191b5fdb876b844b3becae12114646b2b5c34f165a82bbe61a276f9b791746be7b9a4cb7fe70b0c226f186fcb1bc86ba99af167ea70e80e5b66971b72729ae242d29047d29776c11fcce3e56542c94d5ff88f94f1b90450557c2e373a21ffa184d579c6e6529f4633817bf35380bda328940db023800d1772e1df307d91d57596c9a795aea37dc0b4019df604a880bf4050bd8725609779e666a7087c6d091bd74a9b8714f3b05f95223766fcd653750c5af0735570bfd01748cd4a48e6475f7131a5288d4f92fcbe3919f8df9a312c85bbd0e0bae04598288c7b9ae4fe701b827d02dd1df21792f1fbc008bf895c69e50ccd51180832b8da6debb25691f93c3fd35cadd9d45d7abce26a6f1d55173793885afd83bc9d1a0b1d8c01d7cdec39bc11e5a8e193eb6b77de19ab09d3267d7dec3715209cfb058a5e4587cb32193aa5bd6b306f10a03fe6750119a76876429475da8ceb4e1e9d3b557a02b382b1842cc14aab782a7c45e716a616f0eece49d5be3618a3c962ebccdba9d125e6fbf3da5a5b66901cffd7c1e7b6edb7697c4e681907e1a6eec2c41890a9bf3551b7fec1e0ed1589615d5081d2e0a70cd7d05dd03bbdb5e6830c7e07de84dad78904978a2b1fabc69e0211e870ad8cdb41dfc6b39024a6e62cda4ebfeec8d25c5ff86199b1623264b13007f0d17f5bc61df249185fc1dc788b87ce0ff3b46649cd2b04350a17deeed13b045a959b9e2338433c48474f868838385c702359ccb937bf430f022e3dc04f2495a37051519b1f8dce7a289cb39494bd8592a8654e17cde75de7203f2c13f850a35fc48d364c271ed5d7fb9b34952cbf896e6feda89c6c2c200afbc0d896eba8974cbd102ca2da757365b3232facc8fcf443d126abff8b65055f69512fdcce1335cdee43df0b721cd0a2566e61d4de9d601105d2c9573693c29c1a9bd6a20a5b448df677b70d8f2dcd3759dfef26fe36e65c4c14229ef72f4bf023a253e65755b03709d96ca6e3a928daba3c9acbbe41928c7e4b5e6094931ae05c7d53a8558e1fffbdda962aa6490b8c09891c8688e9e0c4f9b31028aa7b0a1193b7ddf60a07e6ddd55d272a8a061dcc4ba86d30455ffe7dc8728d88f5dc2fb9818ace101b77f112c3d0c932688a31439009eabd17b8f31fecf934d7601e9307bb2651285c83c3bfffce1f4833c5b63ba4f51d7287c595eac6ca1961cef13f373fbe9d7899332dc05a6a7e802682b9116b512aadc675587a9dc129a8745156aa4d8f65d60240f610ab8d7b30a2e3b87cb3ac3d46b5d971d1551e2cae22508886ac56117774ddbcc337633742806e4cb248b6faa5a1fa4456a8f3f1a278d0e01b192fe7386e33dcd31664b12030f6f1cc940d66ec4fea81ecfab458c8881a44ed6538e6b21d63cc797fc1785a1919899636c97cc9076770ba5125d93e5595f5e5b7bc89eda79e3c43670093221a84c7f260e78a66ce30fdb13633d4bc86a4f54dea9df28741afb30537b6eef916ae83a531bfbab0a00604f8b3c5f61811b318c8a9d07d4b591273983c449546570b4caef07bbe841a791d69b52554e0b96f691c72a8614ceb1beec7d06f44470a56474e8990ee999c598cf1a6de344214f22c1e377cc1b64e3442272eb5cc6a2ebaf80dc8f6435484136a5773a185b5764ce62f38b8a0f5a1556f275ca87b2b10d508fa748daedbba7f5589c94cfaa133bca6d8f8238f3f215c516dc0c0ed5c791a2b0eacc372510e595ba37882f5a1d1a437ce6ec1ef5dfa53fb4c2b90f59419d2f4e3a3c299b27ef20f6a080a9ec5b77bc4f6fda75aae8d310f2624525cf3ad0f51c090e8370c5df498311a269929a6d982b31d3831153fb55613e44a19ce9c00ad016c515b3d4ea9698a9eb659e8f38062a31c0b069f2b91532a512a1b16764dca752f23568bb029725b6ff6df0cc55082100c3b27adb15ee8060dd39616fb5e2735439b0459b92796c3f887fc9f6d7d800803a0cba944ebb7fe501dd12c39f7ee376774f5c4506d248b5ee5a1469b891b58e3ef7a29983f991c8b4b6d5b76a6eb8f2780cd80f6c0d6f0b831a6078547f26bd5c6f6860e0f102c9952ad0942721db69f97ffeeb57e6722fe880fb11b1e8a9dfbb4b3ab7587decca389eeee532d54acd0e71e1b3aba5374f27c1250307db15a4ec0c713f21af78c4d85e3b7436d15a2a0f16c15c2a35d2da10d9e43dadf1e77973e1f78b6dc9be66d41b817bf891f387130023b944dff7264103ffd68931b301ae353baa17c351f6e8d84bda547f0682860cffbcbc87fd47d23fc6220e64b17159d7817935429849e5ba67b6cf44efe94f9c8831ec60f683a477b44f1f74b30d3dc95c4b794bdb105bc6cdcec2b15e531e9e4ddffc8aa9dbea5cc24de3b394e617d4a9bef9290d3eadca6c53a4872ab004db7c9d052d29d50087a0ab877192163d9c977ac9cb4abe1ef1bd58ae5486e7f5bf2ec3afced0a3027b52af487cd1cd6aa49d174d57d0aa8ce7d614fd0870baa775c60b0b0352acac4e64108f5a374c5f2930542b0ec977c3011d22032be919a6ffa04e7bd6cdb46f9b79b6c978536571620aa25d47669210aaeec105ac54d4d89c14014ccba3e7a0aaab8adaeb51997bab10b4fb659fb6bd0c576b45e1236edde9575560dd16bf347cad8db40ccc2c8c172ea51020e125d445f48e9cfcf7e50450fd22dee318789d4c26d73c76014faf0d9f2566031bf8c8048467c750ee8b25998cb4a90ed44fb09987e25bd905819d455bd06f64755e71b74eb32b83085e31db2254c2013a39b6927e0b5f6a80e968483eccd6ddca74622c1cbf56a8f4b680d77e3ba39faf4bb41f049f2d0cfc0c0cbf499a6e6e525b847b76705e1a48798d97d095e0a768ddd752690005c650cf485e2a64e4d3a98ad7d94aa7f8d289d4f691a04b730b9b475a157f22d6b62794762d57a9e6ef7ef0ca49df40548d151d4e64adf8692ed9e168b6ab46bde4b5d5308e1b761622a73bf37c5a47eb8728ba71b6362c4d87819e5ca4b4d7988ddb4da78bae1a7db4872f231d9b6f672f32c4846078039524cc11981977705e043776ffda6357140351add921f899bfe4bc25f21b0add378a028957b93f9af4a340308c5e22637302fa6ce5ec5eaa9653b13c1d33b9c6d70d694ae4373e4faa13ef818f28df1f4e307e493ff68e2d8eedc2a032acc81154ca239567323a0bfbe118d88c7750a8787e9d0dc0c099b4893c5ddb49cfa97dceb3eef1f6e67f89b3ad1c01292720c49b8d5f825b67c92152448789de3e2be380840cf72eec0ec9357f2df8e429b25f498da581ccec5b4646574f7fab1b518d061431563faf2d640d2104e837932494b52118e0f8fc1308de8adde50164ffb11bc95a89355e461659787af9e89611f8399a5c78e8732b2f58ad3b848a1667a35a747b9b8c9d319f5eadf2f59812b7911f45bf171293bb8a4dd72094d1201d0e8de76130237d624adf0be657ba3f5bec3485a3b1c7858ae1ee4eb72296b86b07d056909755cde70b21aea5a19b86d152f27a72535bd386eedcce6fb9f52c6ae6a1994920000f94cb13a1b667365e477672aa79dee638cab15f7501dd3140e0eef47f749a03a18c3442fe4b9867d81dd55b0c5759f2fe144915fba2d1897776c7f860d88d9cc73fd22bf9d69326702802c636599bb3c73c39b543190f3d72d4b3a4b41e15f744038422d73c1d43a8c3d9b614363f0a3a0f32c3e91355a3dd67e3889c6e535a1dcbbe55efc12120ee44e644f91c85e0758187649ece8e2ff406ace4ed2f5774871ef6f3381fa","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"3bd92bb117687b5361f803e0886d426f"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
