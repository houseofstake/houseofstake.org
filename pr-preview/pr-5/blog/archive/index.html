<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>House of Stake</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #000000;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #000000;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #ffffff;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">House of Stake</p>
                        <p>This content is protected. Please enter the password to continue.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Enter password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember for this session
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="Access Site" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Incorrect password. Please try again.",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f10ae3705f0340bc9980c4154e1c275eac32b8416f6a57e2b88405a4e3ccacd14659beae277803d9defd7f36f1001d1a2d40138cac4bc1288dd98b1e4236bc01ead1952fd1b6f19d84d60da01e3df47df890d141289438b1d1fdc2e5bf7fb7dde664526dafef653b95fdbbf6f6cdeddc22c5b61579f429ac526ec8a3ac6c1cf160ece90a5e7d41271ba690327574c903c21c85803c2ce0854cf04fa3cf97f89b95c3685b3bee94f87c8f9c689d684410dfa16bd345454dcb35684066886a950ff1f6e0e7bbc2e66c92f88a1f50669873577c0bbe117a39bd59ca7b0e7ce7def4c091c452042d26a2de796b62f6194e6f60d52a56695dfba5e85e1e2714bc07e45da388ccccb1706a51cf42e3ce1c60462f0f73e69fe3fff4916b3cafd2f4b17d64fdd36750f8b12aac95780512b23ac3ca3b6dd196418d5f41658d488fb56b66cbc77daadcd11b1d6e15d1f5b3bd53c9a585e8bf8d09de159b47afa8f6f00b2cada8db8e241f176bfb0b205dbbebd936f6aaa75a82abcdc050e6d3b8f814c2f38c0519b49d98799ad18b1c8531f98d13ee2eaef1306cacf0a94bfc49fba8efe5ae8dee27e76bdcb8a4cb434eb72b96032555b952a16eb1a818c0be2a94ffcab2757fb94fd84fc741f9f6f307629a3d1809e399a7d028c5cdf51f02e16ece45e67bf12bdabafd69ec964062522c1938ae28f862ab4d497ffbea236af536ff336e1ebc2ec55c85b81f66a698e7532afa14cc67810799efbf8e444f6ac0c9ccfa0d5231efdafd9c3e561943c47c0cd45f29aacde57e510d2eaf817c4b9c8191b91c435e8a53cce7a6943d19bd317a35026ffdd07ff92a85bddb07bf79848eac706d3bfa0e43459abc9546727273468e553ab67ba191e2f5570c885970ed66e90f41f75f731a5dcd287977dca3d23f13d6ce3e23ca8ff7791325e373b84d437a02781437bca63c425296b5116336302c2ae85b7e173681e1b31dbbd08cf02ad5babce679cf28ba0f3199c252bc34cac9f5864e261775513ab1d118f03a13b49a5a1c90b9707b56070129f450388ab92301fcc2f4809a34be6624e740809cb6dd2b8606bc13907e43649ffd870b97776cf1091be3962c7720e10e327600fdf15ff6872e21dab038745ee99d1152d553b1542da5c7cb6fb66359a3342204f4a7b73a400bf37a91fc7c70b20ad54ad138dd0b6b2a2d6c4951299219ac4739b63b82cfb58a8390926b9f9ac5aa4d994e64738cbd1d15ac7cf3c78746a41d31b7ce71cd410b1306cc090179d66623f6614caba1e0d82201adbcd25cb1c0ea5671d97cf63bf2a41692d2bdfca4aec03b21a54b490e8ad14398df774cacad222d559ff082b8cd2d9125d7a1479ed8b22c03c7371ed5648411d26e8032d8caad0a95bd6f2a48abaa5b6503a9df2e8f5cc7677dab6065b7733790bf87bd83e00ca32fad9692ef69aea48c2415ab05c50a0d4a5e6cb17df16f14b2f835d9429ce04264a1d760a1a606da1de346a318dff391c413737a6245cdb3e7546687ef95c01f1994e00757a27873dbb13c15c2daf4b5a6cc3d672def877f15f18f06296c1c25785f3f9d4ea7b1d96bac15be749f1cba671530bbc844f93010cfdfa61215f39cf526ab07864a98ef800e7004334e6c436a67d823a535920613112fe33eee9636c18a59b496456a8054852c0a7794f56fc6cbb9c2971b35fb4cd2c88a9d8ac8b5e1bcbf0d0022b3ad5a8a0347ed19059e760fc115979b05bb9051d3d8978ea62cc4f4691d6e3ddb5d790e72173574d0db1db7975b4d4e3c9f962b9eb347fcea7f54d046b9581d1bfba1cc22b9213bcecde878a1ce41c1940189e71c7bda9a8f28b57c23fabe5e15235d62149fd764ff05d616681a34cd941b92693ba47ac0730ffc2df4f0f7ab929a3789c35ee3fbb3de500c0afef0bfcbb6039b9b3399a5dffd8154e944a942ca2ef02aed82cacab6b81a069a68696bbea9ef43c5449bf0578d9a162d3341aaf06f5bf8931f59d435f1d88229059aa484eda6ae9ca8f85b2a8f87f716997f5a4e680fe3ff9c04997de22475ae6953098920fc037bdaa4fe2c2f62d20707dff456a95ee98fd61e0e0cc279bb0daaaede26a9cc2ac01c0bfeaa725db7cded26c4a318e1d7b1d129dcc2060382ad130ad742a39f79c6653b0f4f3addd493c2ac0c8a338fbf1f2624fff924df3f9820017dd8bd15b69e35419970575a0ea7f8b57edf8c9000117b699a53f6b175d8bb872c6ffe83dd29875bb8ea190c13ee9414194a7d95250fc56fe26caf7cb8a182e4fd495f4f4391d516f13fd70269002040c17c3234486e81ec65328cd89052d77b588d3ef745fcd57eaa801f28d5ec5a726a3d08832f1929f2214f41942e2edd8cb62e6ced275335fe0304eac1d6ce837df39e8dd73ea6958f2b8acee64d953125d6a5133b7f81b9a89960ae0fe7bcab251d712b9d1223856bd5ceca1a106b707bb24583054f0d1290b4a6caa592ada178636438b9c612bf034aed5bf4bb09effcbd1167ee59ede6a3fd69a552d2a783a641cbc217f890164d69c06ea7e0d8077d0b154cc45e46c67043385e3111486a6b5d2023d9556f35210066324bc000c2fe55a41a0d6ce2ea3d4f84d43345f28ca85113fe0086a6bf9d41fe3eca6866395ced78c94c3602bec23d41ad87fa15868ec775c1e2ed2b713146c00d1b48b037f4fad405b76d68321a07693c8aa0be25b820143df61f453c21064b786c75f211ab38b5a6837e7a6797377af863a9a44e3aba6bb5cc129e26d8c94bfa0e164111015d09a3f228f25d2850e456027cf0c6488f3fc3ee339efe4a48473e14cf4db7c926ee41a3f9dbf21789a0d124e0b6e2ffc243749fd22270871ac52559d1b63ba95ef97c29c3e23af11141c4b4d649d7ef0aea4cb68c447d29682291ec930088943967ed878806fffc58622f485d3de40e79c6dce17e3c5a0aecd50b839dea3a7e5079fb5d67505d382f7d5f7f124a4a0266ef3ed8f3dbe055fffd8df941c00253ddf89cf7bf2191c120da73b473369fafcc86e7cbe40c4994be589af96fdb5d2301bab63aa1d1b118b9684dea8a2ce35f4a561cfb769727f723402ceb5a0636b644f9e1c931a46052dee5bb0ea8010e3fb600b9052cf6745c899817c71da2a84c2959a484e14fcb98874d8eedd194037056628a866bf21e6cba89fb89ce023b6a602a2888926b26cd3c8713387ef73dfc56ea7005087a7b5543571eb3807b5c8ed6b06a84162d89348c1906648b9c1c3939a419b282b03813375fef33a763088f9e1990dcf0c47d10bbca9a59b3a1f69dca371a1c626cc81b430d1c610ee9bc50a4b935966c2ba4dc5960d63cdcdd29549e4a08d9e40a21d9c45fdefa52dbb5599f8ef7aa22c8f6801aba75a0b43402cf50ff194a168cdf549ccdf45efe523994650eef16a06596739525d45538d4f9fb039da9a26df770cffc4753a30079d81e30f44851b6a66f1fd28fb4e11f713c44caacb02f1585ae64eb57fc910b0fb246069a89740e04f9ddffa6c430a5c9f5a50dd1cca2f5c8377e26e0bf9a386a9c98b50b3421c35d90efd0b479fba4a853acca1334a1309abb75af50e0b20eb93b6593ba9fbb40bd2d25ab18b17b60d187090cc736d0721a0e495ef5de72da0971546ffee279e12c1d1da85232290c72f6eb549144d463023e9458820ab41dde6a1ff502ff74946479eb65194d844c05b5998f355f545c71182d30ad3371e376fed895a623bce3667bd78189f4b0b5920e714f49a54602644ced50d5b68dd08e286e9afde9b600f7365a826d135b2ffffdbb3e3e643ddb42a8b2a5d178c9be49f8a95fc1d6d9c3b6d60f3dafd1c430e24b1e2a6844cae58a2cac6c97e81f4caa1746237377085695b86ff225e66072a5c5a3fb77eaf93fcbe26e4ddb817cdab084ba73266c6cd39e710a9ca3013f88261b4d5b351d3e9b05680651628dcf24493ecc075c0a0c0592642dd4b3d3f9c97221876d16ac2e4ad02237719a220218b45e607160d1d84a2c5070b1cfe5a3dbc8072b072ffa227d7f8532918af28876bc0f3b38fbc1b940690e868e1dfa398b39480da15f4e4e49f6cfce04573229127d53d460fde4e5798ff194a574a57638a375123bd3670ffe718b679cae371992778e2078b65968f206ad68795d3b59dab23009f2bdb34bd0706548d3f9565368172d4bf28fdbf23243b9bb4ab5bdea078b5587f21dca0a2c26b6f96bc6dc619611ac6e5ee3b00706bc15b62d7e8122a1f460a2a9e4c891d4083893e96d1124891f30d9d5ccba828fd3361601e61b6fb443a1dfd0f6e9434632a3c0c0918aab05157f298f39054c8d5cfe1647062cdddfe94630f32e7e01d997b64bc19316f8ab869c0b7c16857f490d545dc1d8cf803f9aa0e6efe37d8c35eda9ef079147e5b0bbe1aababcfb9ad5aeab94aaaa8aaae59a2fd39caa7c08bc86be02de0f40ab1793799df1fe1dcd8938fd7933adde8d462384880f92c11423c8b6c83a4c3a33315cff7cb2797115d0a157ffbf838ec86f7da98858f7573b41dfee7cb170d4d8ee6067121825a23220ae3af3762c59190451d895b1338a8ee1b1145873305f6916884591feb28322b086a2eb368a8bd79fa9b2063063d652c132e37fe1c87f52d9029f27f9f81c46dc7438a8e70b692692dacd4b6c1bf93643aa63d6257340ac734cb0f652d29e51ef76d13b9bd29f9ddb05c44252de98f2ac606561374651fa4ada138252eb57252df1e6222cac9694a95edb5085bc8335e90758980e1223f4c0de03047cee07b10396b5bd67de96b1cbef0f304ee8a79d36aaecdafac237b6b00f77f456be594350b1409b7f8c88d0b6aa468ef2aa7af1c8192d407c2489d348dc78c325cba2aa67faaaf265210d5f06cdf969a11321881545e07368e47f59ca4613925cd80d570b94e781932c8fff1c6931204cdd997d77fb73e6f63373e5b21b577bbd9c5a10d88a3e16804f05b62897a8bac175c575fbb5ecba6c559a11e0c8a31f1f2cb9819b99c57aa8bda47f06892fde7083856dd56d5573d689c93d67c9299ba605bf5a46f97ffd8560c0eef38f299dbeda0c591e60545a1775086fb218387274596d00406f196d3e095747448ed0a856c91d0701ae78a77682c0c35f4da3077555386050c2f5436489d3091a806f68dc678002af50f1cdd3cec7916503b98e18b03fda99a0e29747e6051ee00df820dd9956d281138625ce7881b9c27eda0df02cd970eeedfdac47aadeb2819b91e4fcfdba7ec93cd64abe43cbcb4d11bfdcdc53425ead48db0abcd0b19b411c4a36987691a6139856ab3a3cb7e3ae18833937fc2c325ad7963e0681fa506ff68fc364555a60df2202ed512411b5390a07c9f046a9216f37565b800b3c1ea9e72a7153ce980cce4c3b3894548977409777a664626025cee0f316d81ddbedb2bf66edcd873259ee30b0413a5c73f39cec32e090a35aaed475197effd5ca57e2fd5da3bf74d8b5c8680657a0e62853bbe1ea4af1e3e38c0c232d240104dd32e31d6efa12f4474316b54caef19adab16a314051b8ad6a56285b4a24dece7bb13485f707645cdd0658aa7432d155431801ea35a980ceed06602cb7e13f752519728692a06adb039e2f8b7e76e6a5bd6e68cceec2b2de8a73c84800a7ec9a4ce346d1ee62519eaac7dcc33acec0b7ab252918037fa6b75222335ff0034d20f75a38b4023d1f0fdabe6eac940f181cf9bfa9d62b9f2db0007b0d0009272b9652807f9ae713e3a1f6f98747ef8c3fdc58d14497995efd8827cf1d1924e6b77a3039042141105a9d20f4efd5ce2cbace1e7cadeb117b0a28fc9a15d966d6409b69129a2a2060ec4537b4a7c639dc881b9d82d45a493cb76a9d0047ad81f2273bd26a2ead4239cd66d1c32324d22751a5177be10435ef16eb5f0a29f1db05ce5af31a0473cd3ea8d98ffb264c4ed0642b61743ec8868c051c168110fb3723f2ad33657a47c514741d68f11d772b2a11d6178934ab8ebeaeee1449dc14157d8a65da582d6bd2354fb88e43f607d29c0d613262d9c7b9ba7a2d200ff120388565475e6c12dbdf734c6aa8f127cec370c06ef99558c78d9ee9aaed813186ef5b0d5904ccda1b199105c24b00067ae65eb302729c20ccc2863ed5ff1316dcaa0884143c5877e273a38058aa249338deb187576eb8c3d30606aeb645c36bc6258eb2629aaad4c884edfeebbc9ba5319b661e31e59fe1a71cc6b41212e2f8aa8f93761a1db8747e8fc43f30a544807a5f2abf7236eb5e60b1a07bc5e3724b8271f0cb36a68afba367a30eced4ef4fc25d3bcfef165058b46d4a993889b5388c7fd2bca5c5f8a7a052fb73c05bd40fd7cfd2ea47de12561e6f2f9a8eb8c63392daf75c949a9bf0205305ca775e6015c1ab22631fca6e2511c868c043c974d91d4d90c8e3f1cbeb40e16ea3039d7eb1e18c717ec9b19daeda7048c013b854db2b55b42e6c71bcfdf8ff30a71687f88f1234fd3a06afbf3b424cddb7ed631fd3597b6b8190b63a427db8e5a5c29cf3db9f75e278e1e7f7890058fb7fb945bc39921ca44dca95a97cbeee34c50034a018fd9800176a824a95b9fcee166be301685d184326ae192c731d55e3f4b27a965ded3eb2edab921ca36ff8098363d3419163417dcce833668dc0925b17f87b208278dd3ec873a4b6c0e3a2f06556e0ed3916d7ca6e727d993419e53c339f0b04ffc01b088b5f9ce6cb7af4e4d670c4607a403ad4f73a1f9bc860f743028bba4f5c63b08c25c04184fe372a2aac65a25ec61bd4ffe99393cd93efa0501e983cd718800e8ccc30203df4db157954c449c21dfa9b7406ba6c6194015c5d0ff59575f3eb3c2a1fc3c54d23bd2c1a22c0ce41666a2766367ff05da6688871f939e7062d76204f90ad0f75be0f6f9a0c13b179a74905d2c05b214f7682fe5f9e4ae30bfa02471aa4be4e42ffa65401155f0b4ce29e8ab19322f4f4ddb422425cd34ba7a1cfcfdeed8ece63c884e2f33b597e1937c20407d9c1ded0ba74adc23dfaf6217018e413e7624454df822f5b748907a016292800e4dda4812257f0bcfd63c2b93f17b5b25405503911da018478a8dbee7d6f416bdff93a80d1b9416e7a3e2a2fb72004d512061341aabce0bfcd0486379cd8d7963e550352d588ef5001a4e3dbfe1aebda9c770c149c25d3d1dbd7a351fc9a07d311c7d4fe6fd6e177b81bcd36a27804e3cae52726b9e120ba44536e8bb059e888bbf160b6005c5513c2bd742a76f4fcc543c5a5402c48f712e85cbddab5dd014896e95c1f6d66fb5a231cf2567b3c6baff14332d1e7bab637f34dc6862789805ddedb37dcd8eb24ed8f25caeafdb2bec2249a21153ff09a02f9e1f365e64ca262140c92c2af3680d8635f7cd655cc3a750abaec75de8618577d0407cd11a335d1289f7a8c0ca7a9daf5200a0349d851666728962a14330434affb4fade9bae8aee0ab6b8ae35ba0daf166c10b47edba6b0adef01d0cc61b29904e284eb07a330a8f5527510230688841b334c32ec9160c9e5c7c677431b0f5efedacbadd03397a4cda47de36789dc4385d6491fe6b0a99db9fc557c810100c74910321a69209d5fe05deccaa2cef292039735011c69f94c32138d04ffbb601c2f9f10fdf099b8b4efc4f4538e6f99c6d17e6149276e90c84505cd3cdd502db1b381d17b5521a67708905efe61cc2d3efa07bcea0c8c8b351eb8b6c3a9fa262cc2ef45e89985d604169122f923b10d4efc6e8af6ff625269182211a471db05dc786dcba7e992655ca9c48d282dbf089fcc1f18b7b6c5030a1882b77dfa831bcdb0a1c9395ad2c9af21e49e01ca266f6ac1b08152b4b5dfabc39d2122e7725927032280005f5b2f97a4d9b807a626d7fd5afa2d8250cdb873cddd913c96178ae6e7e39175ffc0e53b36fcc3d0ee37ac0341659aeb93e4e04f6250ef3bb643468b6e663c37ff2038bb1dfa2de81e22efbd5dcee3c33f1020125aa7f03386e847bbe13d12fe66a191fb7376f8f4be8c411e8e603925ff79ec9c11a4c4c5470475635f969f7042cb3f5d54d10b574564411f98a8dd61ab11072f2b6d2a12af4a4f5c65b32ef8a8dadcfdf7d00965d887b1c6f5c8d137d8b6dd4c569aa02de1a0b4b3728aac65549df5edb46ebaa33ddc8b8ef2d1c3c20fb55ab674a3e3b52ad87cd369d1c28805938367a1521f8a670e1e130f8248e12a467383711df5ee8d55174c919f65fd8f0e7a45bb2d4b7113bc6948a52fccd1b7aecc7d4b7135580e84bd74a5246b90353a5d114ba4ae0d12f9d93f3e1cbb2880e40f92cafc23a3062cf8fa1828fe9f922e5a69a843b658960b692c4b2d7ae1c234756dc8747c188c6d77f3bb7652d5e6012f83be58931067511c7aaf26fc03a14f813ec012135d07ed5b4ad739a68c9e27f7e59874610c80d8f06740fa7ac5b389493652d174c0d1e9e4aa8f04e2fb183cb43714d577d32b407b1068102599ef7d6323bd3e839b9106f85b4520a2d13619ced766a1aa43669884fb01beb07c477ab0279db818efa3833bdd616a1b23771dd2c80ada9ff6dd3635878088edb610ab825ae68f625f3c66357cccbccb999bbacfffda3b26c6914c4c94da87c57622ffc378185ce1e41c652e4ebdb82fb3ff975554c134ff4d23ad079e04a671b1189951c042489160abb3ff3deffbe226d5177deb13d4aea4ec1f1138ac376fcc0ab2dac04516bb98015cb3b3434869fda9e9fc590e6874c6d5be8b0a921181629ed20353db93d5230bf8b26ba8a48a2283e6eb4041417f646df14bfb850944105f42dbe4bf006d1d5ae51cf456ca89da6b4c99650d549b05bbd25b9b9686c96b2d670f4006ec05b07e2321557f5380b5ea132b995e88913e01406c36de602b93e4b4502ef5f54bf7c53f31ced5a86423964ebbe62e0971e15be946e11842c2458357c93dd1ae681d1f83a317f3118e99c3ce4df92ea6e324db61d52d411fbd42db9857883f194738706eb82d8276eabbf6dda63cbc11539b4a1a8ef52ed408a392be35cd3bae19d30379b41bad35732a5a38ee8b6fdba2056614aac44a24c3c030978b1ba0151a7bd571d3dd47c92215a992aeac4bcdaaedfc0c4f89ffd84d2caa7f71469bbf57cc5de900f23d2dfb4b25d10dbf066115020eb31e76b8ce25171ab7f0f1cf8111b94ddd426a5c567f6b72d1e2051d704043d54d8e223798268347c781606e12838e11203f1e25ad8a5f1cff3aa9c88b5e546fd505807ef5836997cf43c4e9b67f609955b872864d2bb490b059cbe722d3754abd8e7435ae659bb87b87f74bf8f6230df10a9343e0d2dc707740ff82f62d9478b3037adc98c70b02e66bdd381398bbbe58fbb7bff26f589ea87ee3e14aa181e6fef3677932792f657cb225a01b4e61a70f558a2ed965935e0a4a39ae1302a8b5c54d6f919bc6d89537dcec6bdcb0676e5fef88c446edbf29043b8e23797ce2f5f819836ad55b51e767abfdd943fa68413a0d7737945cfc1c3e7d06672355f175d035f199f404f4b6d7a45aaefb7863cdf71a8a0752d7ac19a9a63be5edd2c23208624510205b0f92ec9cdb21f54a2668711b33b9d4cf29bba6e6b7d97b27be17531608a58154e3872a734b727aa3f66d89a410e2d44328bab19b018bbd973d6ef3a56fccffb8fea4d6d691ce8bdee02a7098f34bc9b0741720f586e1d3c64fbf84a51eb449926ffede985182496ee27d5bcaa2385c1f92d10d3a0f30f78a7399438c70ba25555d12e99ba8487bbdf932a0a33d5c277b0ef3aa1a01390d6b781ed6916ac8a3ed46ebce73e4ea16f69811be30c3aff773f412062426a6fcdfd3db25e875e01ec08681b8d8cdd85ff165a45cc6ab79ef9f3272a2769588c9ace8227b6f09074c04e402c77f31394a49f752688471d25474b93782607ce9a02ffba54923a6a2f03b6de27b4ce01cb07270a7a12dc6626548b76dc6f878e072680921474886916de98785ea900cdb69f141e98083e84524619f2049cf80144d78e82f8e68e55418a1024cb194fbf77d7327c35f89b1579e4ab954fe8c042476f999d89622f5633b8b01015e2d095ce1e51daa5b8f82682f6e9589db8e7ade182cb35873750e138dcc1ac5e31c90cbf8b607890232417925c74c6cf8616e14ecff16d8c49e546946764c8eb2653e84b6679631709cd874e080abf766b53e4fcde480031af1d135cf11374f3bdf04d1f66ed86892a06b9a55059e64ba4d51fc1abadbed34e67596470191d59e68848e6bbab818014e7e47b0b5e0e41d46f452cd8e5649e3a1609d92d1351642e118026ab72f69a11831cae187d69b551e2eab627db57ef9c82f50d3a0377fce4a75aa63ff4d24c5ac1a63ae228b365c41894a8113b7106dfea66d6c5ba3980f76512081789b20730dd7fa8300c39d38f27badf60c26c075b279e7a75434285dac6ebf3e8e26da058d3b806aa18d128e812da7bde46f54949c22854e7c21ec802ca682c0ed1ea03f62ea4d07f8d50be32057a887ba6b94f2d83d3286e9d85dcbf7d2067a84bde72f0e3600cac97ca4ba65f543f58dd366dc7c4336af8bee4c2aff41efea0ff2e678e533f1a503e652cd1383e596f20db0bc25c0f121fda7348cb2620b50272a2765fa7d51ad4ec383e45740482505bd9adba575a99bb72e8aa5c8e0d17d9d968aa24a4b52ca08dd050f4393155fc97d9f2112399012704f06c1bb7ee7734c4575c652a768650be428c032569a8370e26a0c839f2911163ee683629b6af72bd67976f21bedb72f8e1d4b50490ea835db624d27709026e6e2dad15d03df6ff66515f8a38d2ed511518e1b566367c167f443dda2acf3c57e16a5f957dcb3baf8ad7d126804c5306777cb316e71a7fa1c7edd8239e033b5fe36bc013992eeaa18498c22ae7efe9d2a0451fc70d2edae1bbc3af68b01838a4ea5a5232444cf16e29e639a1dd0fee6c9b3590c1d3773892f154d12f45acca02c9669605b4c8ed222ae0434c61b921f4383acdef44bb314c771dcf2bec39ecbacbfc7230bc6b0a90614f4ff667de8af6e47e07edbce69e4bb4f719f1a1e0eb83f35c27400d2f39ce46ea1d64c3bcbb9fbaeeb8b7936d2261faab75c257342ffc17fbd3b8212c2e3c743319152e0d109c21d66956cdf0af33cc890191ed35799b9c8f5bbabf3a1513d303bd76a0bcf9d181e571da3d1cad03c6845fcf51f6438f7c9164a53b0dad19abdc363adf2ec279441296b24e5d4627fe065fa256722d60eb8aef5ed3a2a35adae9057006dba9080c2319cd914bb5bae36a6ae2c793efd22233e6e581fe3f254c813f5c7ebc1f2a5bd010b046fc6cb54113d93c715a4275ad3683ada755e346687832630f1ef99f67f3da2b54b03b5a4483461b7bc7553e10cf88f35f893f994b8efa7c47bfa8323fcc5b8955f884d914697bf71b6c37b1626d675c314319f896b18ed1f74fdbd176e5909d8019c943b59d55a6a569e8a0273854de34772f925aa0f2487a2a390ce920230ff9330b43ebf5363b13ec270f121e94e775b7a9bb5f4eb0ea64753bec2a21334c464d413d6e927bb6b57819b68d372014349333b0ac2196d8dcb682ee6cadd730620f04fb82de2d1bf9d5e7b906d1f2c0f7b07a32ffe68c1de9d9745a63aaac1ac8e80ab9d1911d9b88c1856f6324c5a40d285e615aa733ac2bc7bd61191b6998ac85cd43a74efe9bd8810f88213cad117adfe7b458651bba819c220f0d7d5dff217a7cc99a1928de32766496cfad6863bdb98a29342cce3810e26f8ff0ee5627b4ad712b602736fd41d2c292889e89e626f84de128e56acdf6c0b8d743f0a8ed078110c416874862a3ed94c55f7d3e5b9ed3479166cd794b5eb222d6d6083046e52ceca18ecbc707c616226a26eaf79d9af29a906c40b594992934d1eb26351455e81b27851ee4f5cbd8a654e7683bbcf2c70890535cb07a589edb2c03c5d35b10bc1f3266e146e09d8ea47f5a62c40b3a6854fa445a63ceceb8bd69484b5b940ee7de1f940a4ef573dfc014a6f3e70b64d1b0e692040de038854657e0f818861ad5f1f1b591ff5dc4992292b9ba738a8d54de4bd3566013404634045149cc3c123eee40c9e64d3baf7e632d419dc117f0359d93a3656e6420d3a171f264778d9446ff176bed50a93625f3fa4c9e567a83e6c51aca4b37a4ce663c1d122ccafc2353b06d95075ac487361517b9eb36bf3df8183f6fff8800fe193484a4502799caa99526b2ef8209ba4c9fbc0d239d6f1020500a04dd18e0e8127d26c25e9000642252f0b4b8d7417aac8115bfcf4879215ec73283253400388288c48051b834ec109a6a020dbd762f840b3bd56661984e1cbb45ffbf80f94c683f0ad4b3fda0253d7eff4361295ac3b6b8d0194ea578139def414a680a40ae22800920003b54a082edaa1f8e5a79a08714dccdb48d1b610c5354f65f20c94a4e5a12c597d743966a319231106e9691d0352f4c98915007cf0f235061ced769825cd57a97971afdbe8b0d0949bb905202da8a84a494b3ae49f7b904981be0549746510cbcc2cce8cad790963111f4225bd77d8bbc174c50559fa4c797eaa2c898cd6e604a12cc69de11bba719e208d78baa97a79acca4e4dda20259c899200072967cad6512e0f6a79da697b3255020d323639bf8c4de2fa24f33e903061b8bb6fb6a3fe371add83634388106f7033de2d3f9b672d492e8a390aac39a3f475bfa68987f5c3a126c18814fd8891a9a5c7690e201cca59ee8c3f73fdf76b5469720622cacbd5f16dded969d2684307d2c50e2b451d494cd950bde19fdd4f88062ab2c55723cc5c5f5de56986be3ef9ef65565105b22e9506be7ffb5b13855a55dc838493e3d4e575d557ba8d8573313a2550b0b55b9d338d23ebc603b257d4deb188378493cb4b25f9432faebc265db38b661f546ac5601c6e9efa5b078ae965880f610f2e0a7e5bfc983901455a246b33c0a646899b41b4ecd1cc52b82b4a7314b0f1a632ca540adfa4148e0c1600df8cd1d348372723e513f9bc73ff0ec1c9c7543d9fa80accce7ea8ae9b1f0751c5d198c9e7fff13bd853cb59096c1758f51eb0288f70be213c36be6d2cf8bdabeb1b746f995d78f8c8daf88ed244eecb57a3c240f02e7f93dc38c002f91afce22c70b4b7c1c9b5e453c1fc597d2a4eb0930678e0832b63e55dac358544ed330ea2003e85077dbb3682ce87e5e064b2a49186181358ecfd420b3ebca898d9d68cf7bef55b02cdae1c2459877158f42f605a0dcd43c85ed611a4447458a79fb4e8c10d8d483b2de04208240ff8cfca9ce0f6be06292facb30855d9ec69fdd56abeb16449de2dcf2e5f4bb35c7b86e1d757121b761a68d42032141a1a45e3158497323dbce6957986f69c464e3a9b1f33d900bd7a590bbdf5067d499708acd158f919bdf38f1c86779b6f1d23db78b1c186ccb9afd9ac3950ea4c7a423384bd3ab4884a7bbf802ccdeb3a19390bc6a00bbfaeae90f950d018ec758bd47c311ab18f4ee48cb37e0a7dfd18f59bf6d7538882aecd148cd72be7a21aa49115e4bb004bdf7ec68aec8905cabd1179d4e89c6188c0d2913eebe15ddeb69d2cd3834f3535108e88bbb7e99d85f22e564680b78d08c1013257c461856228fc0e82972a1e4b87561ecae47742a2c77efb7b4f12aa7b41e3670e11a67127c7c2918586d7a4004d87f43b67269165ef033af922ab6b7a063547cb572a9fc33784c664a6a32de0c34743ff3d6868ced22c0ce82517d0e21f04e6ee37b47fc6884dc20bac18aac4a2011b7da17845f6dffa9a41fb94f746a11834d5d467d079e2463b33111f79d429356e97c94f20e437756f7d8452e875e88ee9c4fb9d9980fd4c93eebed8e766c5658f3d88ce46fd3eec621cd0eec713e3056ec88e4396bb8b3f3405a6808b1ff39ecab1347efc4550ba9cf88b4eb7ab8856673b24a9590e76fe2c1318e6b385abdc8fc53bcc644961ff5b8f572620417669f2d99d51bdf4f37b995dc8218873d9bde65449696a0f1e857dc194f3d05042525bae73e6c462d84135eb39e2801de34483ac657308d6dc709a5199232dee996013806a070d604570c0ebfe8e2ad5934971a3c99d17ee5614ae85272c899d4334afbdb09d850af5f09062b27dda55c125f2687034acb69d18ffb6341fc37bc158516a59f4d68618209fa27f191ccef6229f1f2814a371906d3ca48bb17c097c97840697b01571394c3dd214fafa864e217abf596b0d9c239e3b8ce44c01c3bc360cd3ef887439460cbcc020494ee7b35ab997d1b5d90a2affc1a1e8e9e7e5c2c78711262257f34c64b195e5b224d46e296838d457a9dc783675b3946a165843e017e7f1f101bf9b7ef2d69a4275da479e4c9bc75ab4eb94fc966890db48b17f1aa4714edc441d8d642ab9e3db1f0a29beb04ed1d9c1ab0f94170df52fa339d2f934e0c5336168d5b1d42df779202e890075e6189bd4b34fc05f1e5d9f92e843557c982c1ecbba5f26feeb6d29630cb5456b9b6dea236d6224938e5d3d5a2d47ad10df999535bc958d375c3549522fe33d99a918aaa0d05d1d277c3f20c282ec2a428b158aadd115d44a756777865530248875272da4878fb2ceea2bf1b639a01d07713535cfda89914940910336dad0a511424886302122678cb0ed6b911035cef7cd12a432286833f5b621f3fd3dc68b76cd4b3f8b3056c9458e317d1b11f780be2b5df03a62e49daa725aac7d29d5e21d1bc1db0bb3b17e6eeba50984cf47971022c48b07edb27539c97e7a31c67e56100ac56093d0f29abb6991c3ac8645b3b43e4b5922869b065081fe1c4d8213913753209a90014d839b1212acb3ada4adffdd5222618ef69af0090634904043d502d89c0855e8d16d942b2348d8758ea23ef0413993c0ddf5c54c000b6e353b251894874a805761f64fd2e9c37c90def1a7e36cad39d9ee99d55d10a3720d1b2cc5cdcbf92d501221ac2085d5e68aeaf1b382c5e557cb8d7f28cba9e2a10ec8f09299737dd47b0837969ef045ae8a2be5737540195b838e66aca30ee5579e96e1887f16a8dd87182248da60cbdd57cd215dd389e18df65000386173516fb9d016cdfecc6279360e5520e07e7d2a36c3870149b6d4bbc471c925f811c2d0be38fb0529f786db6fe2f7f9299f725a82a77f525e5ea8fce679f7094e45e551c7ac3a5bac96c70f6ae9cb6a00255eb0884725b75b32515c97e0c4e11146e90851b570e467f6ec3cd03d71aa44c37be7535eb5a111cc3e328c2651e32bf44cf744e35a66eabeb0a271795763f1bcc97c3d1408350ffe234a2c451079fa6ebebc56825c586422c2172440af2dfd22db7dde8df14d50dc9a0b94a246c09f2fb26d702e6de9f91bdd682319c0f970c23da329bf1902dd50c21f85d54dfa8edc73d8c0f014d0bf450b2d4fb4d3d4c8e503f71e156d77bd384bc25e4bf2c090575ca63d21a70783a101e44c766278d9887268d9f98a934ae19866528ee2673a3a475ec0be9cfb70daf11b294ee430129c684675d1d691e7736b1be4fa6ef7148e5592488fc9e83b9861a2d646ee7ebb07a4e8f95615894175a8bbf3d7f90f932054523669d11907a599dfa46e4f26f047c3de4599403981c25d8d6efafe4174262aafc73032873c74ad1139448ea19325e3e4baf3c0a5b7aa245cd0f3e51bdb97c24c9710aa838abb2a5199cebd7d1c15a54cd9089320f8ebe5e9e47293dfcd8df7b085b04e0ec67f8cf07a70e8068e1d4d5574109314962e39498d9f018ca1b2b89ed665c2d1eba4fc0b911b21445756f96f7ed08a1bc7a8b1d1b338a93f219714217e20ce2c2c5372c3d6ee9c58f3d71a4d246fc6c3e629b565830136a6e55931cd933ddf96c6cb5f393c0fc27a7da620d62522e","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"e2468ae4da1f00a5f24932712ab58fc4"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
